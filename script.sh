clear; KEY="helloworld"; printf "\nWelcome to ncat chat\n\n"; read -p 'Enter Username: ' USER; echo '30 - black'; echo '31 - red'; echo '32 - green'; echo '33 - yellow'; echo '34 - blue'; echo '35 - magenta'; echo '36 - cyan'; echo '37 - white'; read -p 'Choose colour (30-37): ' COLOUR; clear; echo ; mawk -v user="$USER" -v colour="$COLOUR" -v end="\033[m" -v key="$KEY" -W interactive '{gsub("\"", "\\\\\042", $0); cmd="echo \"\033[" colour "m" user ": " end $0 "\033[0m\" | openssl enc -aes-256-cbc -base64 -A -k " key; cmd|getline a; print a; close(cmd);}' | nc 192.168.0.168 3333 | awk -v key="$KEY" '{ cmd="unset v; read -r v; echo $v | openssl enc -d -aes-256-cbc -base64 -k " key " 2>/dev/null"; print $0 |& cmd; cmd |& getline a; close(cmd); print strftime("[%Y-%m-%d %H:%M:%S]"),a,"\033[0m"; fflush(stdout) }' | sed -e "s/\(*\)\(.*\)\(*\)/\x1b[1m\2\x1b[21m/g" -e "s/\(_\)\(.*\)\(_\)/\x1b[4m\2\x1b[24m/g" -e "s/\(\^\)\(.*\)\(\^\)/\x1b[5m\2\x1b[25m/g" -e "s/\(%\)\(.*\)\(%\)/\x1b[7m\2\x1b[27m/g" -e "s/@\([0-9]\+\)/\x1b[\1m/g" 
